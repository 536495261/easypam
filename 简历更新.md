# 简历更新 - 文件去重存储 + 热点文件缓存

## 新增亮点

1. **内容寻址存储：** 基于文件 MD5 的去重存储，相同内容只存一份，引用计数管理生命周期，节省存储空间
2. **多级缓存：** Caffeine 本地缓存 + Redis 分布式缓存，Redis ZSET 统计访问频次识别热点文件

## 更新后的完整简历

**EasyPAM 云盘** ｜ 后端开发 ｜ 2024.xx - 2025.xx

基于微服务架构的个人云盘系统，支持文件存储、分享、全文搜索等功能

**技术栈：** Spring Cloud + RocketMQ + MinIO + MySQL + Redis + Elasticsearch + Sentinel

**主要工作：**
- **分片上传：** 大文件分片上传至 MinIO，数据库持久化进度支持断点续传，MD5 秒传避免重复上传
- **内容寻址存储：** 基于文件 MD5 的去重存储，相同内容只存一份，引用计数管理生命周期，节省存储空间
- **多级缓存：** Caffeine 本地缓存 + Redis 分布式缓存，Redis ZSET 统计访问频次识别热点文件
- **分布式事务：** 本地消息表 + RocketMQ 异步投递，指数退避重试 + 乐观锁防并发，保证跨服务最终一致性
- **异步搜索索引：** Producer 顺序发送 + 本地消息表补偿；Consumer 顺序消费保证操作时序，利用 ES 幂等特性 + MQ 重试保证索引可靠性
- **双 Token 认证：** 短期访问令牌 + 长期刷新令牌分离，jti 黑名单实现主动失效，支持多设备登录管理
- **多层限流：** 网关层全局限流防止系统过载，业务层滑动窗口实现 IP/用户细粒度限流，规则动态加载

---

## 面试话术 - 多级缓存

**面试官：介绍一下多级缓存？**

答：我实现了两级缓存来加速文件元数据查询：

1. **L1 本地缓存（Caffeine）**：毫秒级响应，LRU 淘汰，最大 1 万条，10 分钟过期
2. **L2 分布式缓存（Redis）**：跨实例共享，30 分钟过期

**查询流程**：L1 → L2 → DB，命中后回填上层缓存

**热点识别**：用 Redis ZSET 记录文件访问次数，`ZINCRBY` 原子累加，`ZREVRANGE` 获取 Top N 热点文件

**为什么用两级？**
- 本地缓存：速度快，减少网络开销
- Redis 缓存：分布式共享，多实例一致性

**面试官可能追问：**
- 缓存一致性怎么保证？→ 更新/删除时主动清除两级缓存
- 缓存穿透怎么办？→ 可以缓存空值或用布隆过滤器
- 热点 key 问题？→ 本地缓存兜底，不会全部打到 Redis
